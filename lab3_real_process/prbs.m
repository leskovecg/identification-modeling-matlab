function y=prbs(n)
% function y=prbs(n)
% n = length of the shift register (initial condition of bits 111...1)
% y = vector of the length 2^n-1: series of values 1 and 0

x{2} = [2,1];
x{3} = [3,2];
x{4} = [4,3];
x{5} = [5,3];
x{6} = [6,5];
x{7} = [7,6];
x{8} = [8,6,5,4];
x{9} = [9,5];
x{10} = [10,7];
x{11} = [11,9];
x{12} = [12,6,4,1];
x{13} = [13,4,3,1];
x{14} = [14,5,3,1];
x{15} = [15,14];
x{16} = [16,15,13,4];
x{17} = [17,14];
x{18} = [18,11];
x{19} = [19,6,2,1];
x{20} = [20,17];
x{21} = [21,19];
x{22} = [22,21];
x{23} = [23,18];
x{24} = [24,23,22,17];
x{25} = [25,22];
x{26} = [26,6,2,1];
x{27} = [27,5,2,1];
x{28} = [28,25];
x{29} = [29,27];
x{30} = [30,6,4,1];
x{31} = [31,28];
% x{32} = [32,22,2,1];
% x{33} = [33,20];
% x{34} = [34,27,2,1];
% x{35} = [35,33];
% x{36} = [36,25];
% x{37} = [37,5,4,3,2,1];
% x{38} = [38,6,5,1];
% x{39} = [39,35];
% x{40} = [40,38,21,19];
% x{41} = [41,38];
% x{42} = [42,41,20,19];
% x{43} = [43,42,38,37];
% x{44} = [44,43,18,17];
% x{45} = [45,44,42,41];
% x{46} = [46,45,26,25];
% x{47} = [47,42];
% x{48} = [48,47,21,20];
% x{49} = [49,40];
% x{50} = [50,49,24,23];
% x{51} = [51,50,36,35];
% x{52} = [52,49];
% x{53} = [53,52,38,37];
% x{54} = [54,53,18,17];
% x{55} = [55,31];
% x{56} = [56,55,35,34];
% x{57} = [57,50];
% x{58} = [58,39];
% x{59} = [59,58,38,37];
% x{60} = [60,59];
% x{61} = [61,60,46,45];
% x{62} = [62,61,6,5];
% x{63} = [63,62];
% x{64} = [64,63,61,60];
% x{65} = [65,47];
% x{66} = [66,65,57,56];
% x{67} = [67,66,58,57];
% x{68} = [68,59];
% x{69} = [69,67,42,40];
% x{70} = [70,69,55,54];
% x{71} = [71,65];
% x{72} = [72,66,25,19];
% x{73} = [73,48];
% x{74} = [74,73,59,58];
% x{75} = [75,74,65,64];
% x{76} = [76,75,41,40];
% x{77} = [77,76,47,46];
% x{78} = [78,77,59,58];
% x{79} = [79,70];
% x{80} = [80,79,43,42];
% x{81} = [81,77];
% x{82} = [82,79,47,44];
% x{83} = [83,82,38,37];
% x{84} = [84,71];
% x{85} = [85,84,58,57];
% x{86} = [86,85,74,73];
% x{87} = [87,74];
% x{88} = [88,87,17,16];
% x{89} = [89,51];
% x{90} = [90,89,72,71];
% x{91} = [91,90,8,7];
% x{92} = [92,91,80,79];
% x{93} = [93,91];
% x{94} = [94,73];
% x{95} = [95,84];
% x{96} = [96,94,49,47];
% x{97} = [97,91];
% x{98} = [98,87];
% x{99} = [99,97,54,52];
% x{100} = [100,63];
% x{101} = [101,100,95,94];
% x{102} = [102,101,36,35];
% x{103} = [103,94];
% x{104} = [104,103,94,93];
% x{105} = [105,89];
% x{106} = [106,91];
% x{107} = [107,105,44,42];
% x{108} = [108,77];
% x{109} = [109,108,103,102];
% x{110} = [110,109,98,97];
% x{111} = [111,101];
% x{112} = [112,110,69,67];
% x{113} = [113,104];
% x{114} = [114,113,33,32];
% x{115} = [115,114,101,100];
% x{116} = [116,115,46,45];
% x{117} = [117,115,99,97];
% x{118} = [118,85];
% x{119} = [119,111];
% x{120} = [120,113,9,2];
% x{121} = [121,103];
% x{122} = [122,121,63,62];
% x{123} = [123,121];
% x{124} = [124,87];
% x{125} = [125,124,18,17];
% x{126} = [126,125,90,89];
% x{127} = [127,126];
% x{128} = [128,126,101,99];
% x{129} = [129,124];
% x{130} = [130,127];
% x{131} = [131,130,84,83];
% x{132} = [132,103];
% x{133} = [133,132,82,81];
% x{134} = [134,77];
% x{135} = [135,124];
% x{136} = [136,135,11,10];
% x{137} = [137,116];
% x{138} = [138,137,131,130];
% x{139} = [139,136,134,131];
% x{140} = [140,111];
% x{141} = [141,140,110,109];
% x{142} = [142,121];
% x{143} = [143,142,123,122];
% x{144} = [144,143,75,74];
% x{145} = [145,93];
% x{146} = [146,145,87,86];
% x{147} = [147,146,110,109];
% x{148} = [148,121];
% x{149} = [149,148,40,39];
% x{150} = [150,97];
% x{151} = [151,148];
% x{152} = [152,151,87,86];
% x{153} = [153,152];
% x{154} = [154,152,27,25];
% x{155} = [155,154,124,123];
% x{156} = [156,155,41,40];
% x{157} = [157,156,131,130];
% x{158} = [158,157,132,131];
% x{159} = [159,128];
% x{160} = [160,159,142,141];
% x{161} = [161,143];
% x{162} = [162,161,75,74];
% x{163} = [163,162,104,103];
% x{164} = [164,163,151,150];
% x{165} = [165,164,135,134];
% x{166} = [166,165,128,127];
% x{167} = [167,161];
% x{168} = [168,166,153,151];

n = round(n);
if (n > 31)
    error('Maximal register length is 31.')
elseif (n < 1)
    error('Minimal register length is 1.')
else
    sh_reg = uint32(2)^n-1;
end

bits = uint32(x{n});

y = zeros(2^n-1,1);

for i=1:2^n-1
    f_back = uint32(rem(sum(bitget(sh_reg,bits)),2));
    sh_reg = bitshift(sh_reg,  1) + f_back;
    y(i,:) = bitshift(sh_reg, -n);
    sh_reg = bitset(sh_reg, n+1, 0);
end
